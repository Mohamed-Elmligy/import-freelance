<page-header
  [withBreadCrumb]="false"
  [title]="'transactions' | translate"
  [route]="route"
/>

@if ((transactionId && isUpdate) || (!transactionId && !isUpdate)) {
<form
  class="bg-white p-8 rounded-md shadow-lg max-w-7xl mx-auto space-y-8"
  [formGroup]="form"
  (ngSubmit)="submit(form)"
>
  <p-floatlabel class="w-80">
    <p-select
      id="invoiceNumber"
      [options]="listOfInvoices()"
      optionLabel="invoice_number"
      [filter]="true"
      [showClear]="true"
      styleClass="w-full"
      formControlName="invoiceNumber"
      (ngModelChange)="getInvoiceData($event.id); getPaymentData($event.id)"
    />
    <label for="invoiceNumber">{{ "invoiceNumber" | translate }}</label>
  </p-floatlabel>

  <div class="grid grid-cols-1 gap-8 lg:grid-cols-3 md:grid-cols-2 mt-6">
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "name" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ invoiceData().customer }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "supplier" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ invoiceData().supplier }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "transactionDate" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ invoiceData().invoice_date | date : "dd/MM/yyyy" }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "amount" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ invoiceData().total_amount }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "netAmount" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ invoiceData().net_amount }}
      </p>
    </div>
  </div>

  <p-table
    [value]="paymentData().available_payments"
    styleClass="mt-6"
    [tableStyle]="{ 'min-width': '50rem' }"
  >
    <ng-template pTemplate="header">
      <tr>
        <th class="py-4">{{ "paymentNumber" | translate }}</th>
        <th class="py-4">{{ "paymentDate" | translate }}</th>
        <th class="py-4">{{ "amount" | translate }}</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
      <tr>
        <td class="py-4">{{ item.payment_number }}</td>
        <td class="py-4">{{ item.date | date : "dd/MM/yyyy" }}</td>
        <td class="py-4">{{ item.amount }}</td>
      </tr>
    </ng-template>
  </p-table>

  <div class="grid grid-cols-1 gap-6 md:grid-cols-3 mt-6">
    <p-floatlabel class="w-full">
      <p-select
        id="invoice_payment_number"
        [options]="transactionService.paymentBatchies()"
        optionLabel="name"
        optionValue="id"
        [filter]="true"
        [showClear]="true"
        styleClass="w-full"
        formControlName="invoice_payment_number"
      />
      <label for="invoice_payment_number">{{
        "invoice_payment_number" | translate
      }}</label>
    </p-floatlabel>
    <p-floatlabel class="w-full">
      <input
        pInputText
        id="remaining"
        autocomplete="off"
        class="w-full"
        formControlName="remainingAmount"
      />
      <label for="remaining">{{ "remainingAmount" | translate }}</label>
    </p-floatlabel>

    <p-floatlabel class="w-full">
      <p-datepicker
        inputId="date"
        showIcon
        iconDisplay="input"
        styleClass="w-full"
        formControlName="transactionDate"
      />
      <label for="date">{{ "transactionDate" | translate }}</label>
    </p-floatlabel>
  </div>

  <div class="mt-6">
    <p-floatlabel class="w-full">
      <textarea
        pTextarea
        id="Statement"
        rows="5"
        cols="30"
        style="resize: none"
        class="w-full"
        formControlName="description"
      ></textarea>
      <label for="Statement">{{ "description" | translate }}</label>
    </p-floatlabel>
  </div>

  <div class="flex justify-end mt-8 space-x-4">
    <p-button
      class="rounded-md text-white w-full font-semibold px-6 py-3"
      [label]="'save' | translate"
      [raised]="true"
      type="submit"
    />
    <p-button
      class="rounded-md text-gray-600 w-full font-semibold px-6 py-3"
      [label]="'clear' | translate"
      [raised]="true"
      severity="contrast"
      type="button"
      (onClick)="reset(form)"
    />
  </div>
</form>
} @if (transactionId && !isUpdate) {
<div class="bg-white p-8 rounded-md shadow-lg max-w-7xl mx-auto space-y-8">
  <div class="grid grid-cols-1 gap-8 lg:grid-cols-3 md:grid-cols-2 mt-6">
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "name" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ transactionData.customer }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "supplier" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ transactionData.supplier }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "transactionDate" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ transactionData.pay_date | date : "dd/MM/yyyy" }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "amount" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ transactionData.amount }}
      </p>
    </div>
    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "invoice_payment_number" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ transactionData.invoice_payment_number }}
      </p>
    </div>

    <div class="flex flex-row align-baseline justify-content-center">
      <h2 class="text-gray-700 text-lg font-semibold">
        {{ "description" | translate }}:
      </h2>
      <p class="text-gray-900 text-lg ms-2">
        {{ transactionData.discription }}
      </p>
    </div>
  </div>
</div>
}
